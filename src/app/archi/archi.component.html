<app-header></app-header>
<section class="w-full h-screen mx-auto flex dark:bg-gray-900">
    <div *ngIf="!otherAdd" class="lg:w-[100%] md:w-[90%] sm:w-[92%] xs:w-[96%] mx-auto flex items-center justify-center">
        <div class="w-full md:p-6 xs:p-4 rounded-lg md:mt-0 sm:p-8 dark:bg-gray-900">
            <div class="w-full mx-auto shadow-xl rounded-sm border border-gray-200 dark:border dark:border-gray-800">
                <h1 class="text-2xl font-semibold p-4 bg-gray-200 shadow-lg dark:bg-gray-800 dark:text-white rounded-sm">
                    Ajouter une batisse a votre architecutre d'hopital
                </h1>
                <div class="w-full md:flex sm:gap-2 xs:gap-0">
                    <div class="lg:w-[20%] md:w-[30%] xs:w-full bg-gray-100 flex md:flex-col xs:flex-row xs:justify-center sm:gap-2 dark:bg-gray-700">
                        <div *ngFor="let step of steps; let i = index"
                             [ngClass]="{'bg-blue-500 text-white': currentStep === i + 1, 'hover:bg-gray-400 hover:text-white': currentStep !== i + 1}"
                             class="step-btn text-gray-900 rounded-sm py-2 border-b-2 border-gray-200 dark:border-b-2 dark:border-gray-600 pl-4"
                             [class.cursor-pointer]="i < currentStep"
                             (click)="i < currentStep ? goToStep(i + 1) : null">
                            <div class="flex md:gap-2 sm:text-xl xs:text-md font-semibold dark:text-white">
                                Step - <h1 class="md:text-3xl xs:text-lg sm:text-white flex justify-center sm:px-2 sm:bg-blue-500 rounded-lg">{{ i + 1 }}</h1>
                            </div>
                        </div>
                    </div>
                    <div *ngIf="currentStep === 1" id="step1-content" class="step-content md:w-[88%] xs:w-[92%] px-4 py-6">
                        <div class="text-center block mb-2 text-sm font-medium text-gray-900 dark:text-white">Ajouter un batiment </div>
                       
                            <!--Name input-->
                            
                                <div class="w-full">
                                    <label for="first_name" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">{{'ajoutC1.nom' | translate }}</label>
                                    <input [(ngModel)]="nomsBatiment" type="text" class="bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500" required>
                                </div>
                            
          
                            <!--Type input-->
                            <div class="w-full">
                                <label for="first_name" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">{{'ajoutC1.type' | translate }}</label>
                              <select *ngIf="typesBatiment !== 'Autre'" [(ngModel)]="typesBatiment"
                                
                                class="block mb-2 text-sm text-gray-700 bg-white border border-gray-300 rounded-md focus:border-blue-400 focus:ring-blue-300 focus:ring-opacity-40 focus:outline-none focus:ring">
                                <option *ngFor="let categorie of categoriesLocaux">{{ categorie }}</option>
                              </select>
          
                              <input *ngIf="typesBatiment === 'Autre'" [(ngModel)]="typeBatiment"
                                type="text"
                                class="block mb-2 text-sm text-gray-700 bg-white border border-gray-300 rounded-md focus:border-blue-400 focus:ring-blue-300 focus:ring-opacity-40 focus:outline-none focus:ring">
                            </div>
          
                            <button
                             (click)="ajouterNew(nomsBatiment,typeBatiment||typesBatiment)"
                              [class.enfonce]="boutonsAjouterEnfonce"
                              class="px-5 mx-2 my-2 font-medium text-white transition-colors duration-300 transform bg-[#3b82f6] rounded-md disabled:bg-gray-300 hover:bg-blue-300 focus:outline-none whitespace-nowrap">
                              {{'architecture.ajouter' | translate }}
                            </button>
                       
                        
                        <ng-container *ngIf="batimentAjoute">
                            <div class="flex flex-wrap lg:w-4/5 sm:mx-auto sm:mb-2 -mx-2 p-4">
                                 <div class="bg-gray-100 rounded flex p-4 h-full items-center">
                                  <svg fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"
                                    stroke-width="3" class="text-indigo-500 w-6 h-6 flex-shrink-0 mr-4" viewBox="0 0 24 24">
                                    <path d="M22 11.08V12a10 10 0 11-5.93-9.14"></path>
                                    <path d="M22 4L12 14.01l-3-3"></path>
                                  </svg>
                                  <span class="font-normal">
                                    {{'ajoutC1.batiment' | translate}}
                                    <span class="font-medium">{{ nomsBatiment }}</span>
                                    {{'ajoutC1.ajoutee' | translate}}
                                  </span>
                                
                              </div>
                            </div>
                          </ng-container>
                    </div>
                    <div *ngIf="currentStep === 2" id="step2-content" class="step-content md:w-[88%] xs:w-[92%] px-4 py-6">
                    <div *ngIf="!batimentAjoute"  class="text-center block mb-2 text-sm font-medium text-gray-900 dark:text-white">
                        Aucun batiment ajoutée veuillez d abord saisir les données du batiment
                    </div>
                    <div *ngIf="batimentAjoute" >
                        <div class="text-center block mb-2 text-sm font-medium text-gray-900 dark:text-white">Ajouter des etages </div>
                       
                        <!-- Step 2 Inputs -->
                        <div class="w-full">
                            <label for="address" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">   Saisir le nombre d'étages dans le batiment {{ nomsBatiment }}
                            </label>
                        </div> 
                        <input *ngIf="nombreEtages >= 1" [(ngModel)]="nombreEtages" required type="number"
                  (change)="generateBuildingNames()"
                  class="block w-full px-4 py-2 mt-2 text-gray-700 bg-white border border-gray-300 rounded-md focus:border-blue-400 focus:ring-blue-300 focus:ring-opacity-40 focus:outline-none focus:ring">
                <input *ngIf="nombreEtages < 1" [(ngModel)]="nombreEtages" required type="number"
                  (change)="generateBuildingNames()"
                  class="block w-full px-4 py-2 mt-2 text-gray-700 bg-white border border-gray-300 rounded-md border-red-400 ring-red-300 focus:ring-opacity-40 dark:focus:border-blue-300 focus:outline-none focus:ring">
                  <div class="grid grid-cols-1 gap-6 mt-4">
                    <ng-container *ngFor="let i of [].constructor(nombreEtages); let index = index">
                      <div>
                        <div class="block mb-2 text-sm font-medium text-gray-900 " style="font-size: medium;">
                          {{'ajoutC1.etage' | translate}} {{ index + 1 }}
                        </div>
                        <!--nom etage-->
                        <div class="flex w-full gap-6">
                          <div class="flex gap-10 items-center my-2">
                            <label class="block text-sm font-medium text-gray-900 "
                              style="font-size: small;">{{'ajoutC1.nom' | translate}}</label>
                            <input [(ngModel)]="nomsEtages[index]" type="text"
                              class="block w-full px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-md dark:bg-gray-800 dark:text-gray-300 dark:border-gray-600 focus:border-blue-400 focus:ring-blue-300 focus:ring-opacity-40 focus:outline-none focus:ring">
                          </div>
    
                          <button *ngIf="nomsEtages[index] && nomsEtages[index].length > 0"
                            (click)="ajouterNewEtage(nomsEtages[index],typeBatiment ,batimentId, index)"
                            [class.enfonce]="boutonsAjouterEtageEnfonce[index]"
                            class="px-5 mx-2 my-2 font-medium text-white transition-colors duration-300 transform bg-[#3b82f6] rounded-md disabled:bg-gray-300 hover:bg-blue-300 focus:outline-none whitespace-nowrap">
                            {{'architecture.ajouter' | translate }}
                          </button>
                        </div>
    
                      </div>
                      
                    </ng-container>
                  </div>
    
                    </div>
                    <ng-container *ngIf="tousLesNomsEtages.length > 0">
                        <div class="flex flex-wrap lg:w-4/5 sm:mx-auto sm:mb-2 -mx-2 p-4">
                          <div *ngFor="let nom of tousLesNomsEtages" class="p-6 sm:w-1/2 w-full">
                            <div class="bg-gray-100 rounded flex p-4 h-full items-center">
                              <svg fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"
                                stroke-width="3" class="text-indigo-500 w-6 h-6 flex-shrink-0 mr-4" viewBox="0 0 24 24">
                                <path d="M22 11.08V12a10 10 0 11-5.93-9.14"></path>
                                <path d="M22 4L12 14.01l-3-3"></path>
                              </svg>
                              Etage : <span class="font-medium">{{ nom }} ajouté</span>
                            </div>
                          </div>
                        </div>
                      </ng-container>
                    </div>
                    <div *ngIf="currentStep === 3" id="step3-content" class="step-content md:w-[88%] xs:w-[92%] px-4 py-6">
                      <div *ngIf="!batimentAjoute"  class="text-center block mb-2 text-sm font-medium text-gray-900 dark:text-white">
                        Aucun batiment ajoutée veuillez d abord saisir les données du batiment
                    </div>
                    <div *ngIf="batimentAjoute" >
                        <div class="text-center block mb-2 text-sm font-medium text-gray-900 dark:text-white">Ajouter des locaux </div>
                        <div class="grid grid-cols-1 gap-6 mt-4 sm:grid-cols-2">
                            <div *ngIf="indiceEtage2Courant < tousLesEtagesSansException.length">
                              <div>
                              
                                <div>
                                  <div class="w-full">
                                    <label class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">
                                      {{'architecture.nombreLocaux'|translate}} {{
                                      tousLesNomsEtagesSansException[indiceEtage2Courant] }}
                                    </label>
                                  </div>
                                  <input *ngIf="nombreZones >= 1" [(ngModel)]="nombreZones" required type="number"
                                    (change)="generateBuildingNames()"
                                    class="block w-full px-4 py-2 mt-2 text-gray-700 bg-white border border-gray-300 rounded-md focus:border-blue-400
                                    focus:ring-blue-300 focus:ring-opacity-40 focus:outline-none focus:ring">
                                  <input *ngIf="nombreZones < 1" [(ngModel)]="nombreZones" required type="number"
                                    (change)="generateBuildingNames()"
                                    class="block w-full px-4 py-2 mt-2 text-gray-700 bg-white border border-gray-300 rounded-md focus:border-blue-400
                                    focus:ring-blue-300 focus:ring-opacity-40 focus:outline-none focus:ring">
                  
                                  <div class="grid grid-cols-1 gap-6 mt-4">
                                    <ng-container *ngFor="let i of [].constructor(nombreZones); let index = index">
                                      <!-- <label class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">
                                        {{tousLesTypesEtages[indiceEtage2Courant]}}
                                      </label>
                   -->
                  
                                      <div>
                                        <div class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">
                                          Local {{ index + 1 }}
                                        </div>
                                        <div>
                                          <!-- Type local -->
                                         
                                            
                                              <!-- <div *ngIf="typeLocalSelectionne[index] !== 'Autre'">
                                                
                                                  <label class="block text-sm font-medium text-gray-900 "
                                                    style="font-size: medium;">
                                                    {{'ajoutC1.type'|translate}}
                                                  </label>
                                                  <select *ngIf="typeLocalSelectionne[index] !== 'Autre'"
                                                    [(ngModel)]="typeLocalSelectionne[index]"
                                                    class="block w-full px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-md focus:border-blue-400 focus:ring-blue-300 focus:ring-opacity-40 focus:outline-none focus:ring">
                                                    <option
                                                      *ngFor="let typeLocal of categoriesAvecTypesLocaux[typeBatimentSelectionne]">
                                                      {{ typeLocal }}
                                                    </option>
                                                  </select>
                                                
                                              </div> -->
                                             <!--  <div
                                              *ngIf="typeLocalSelectionne[index] === 'Autre'|| !categoriesAvecTypesLocaux[tousLesTypesBatiments[indiceEtage2Courant]]">
                                            -->    <div class="">
                                                  <label class="block text-sm font-medium text-gray-900 "
                                                    style="font-size: medium;">
                                                    {{'ajoutC1.nom'|translate}}
                                                  </label>
                                                  <input [(ngModel)]="nomsZones[index]" type="text"
                                                    class="block w-full px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-md focus:border-blue-400 focus:ring-blue-300 focus:ring-opacity-40 focus:outline-none focus:ring">
                                               
                                                   <!--Température-->
               
                  
                    <label for="" class="block mb-2 text-sm font-medium text-gray-900 ">Préciser les seuils de température dans ce
                      local (°C)</label>
                    <div class="flex gap-6 items-center justify-between">
                      <div class="flex items-center gap-6">
                        <label for="" class="block mb-2 text-sm font-medium text-gray-500 " style="min-width: fit-content;">De
                          :</label>
                        <input [(ngModel)]="temperatureMin[index]" placeholder="" type="number" id="tempMin" name="tempMin"
                          class="my-2 bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-blue-600 focus:border-blue-600 block w-full p-2.5 -700 hover:shadow-md">
                      </div>
                      <div class="flex items-center gap-6">
                        <label for="" class="block mb-2 text-sm font-medium text-gray-500 " style="min-width: fit-content;">à
                          :</label>
                        <input [(ngModel)]="temperatureMax[index]" placeholder="" type="number" id="tempMax" name="tempMax"
                          class="my-2 bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-blue-600 focus:border-blue-600 block w-full p-2.5 -700 hover:shadow-md">
                      </div>
                    </div>
                
               

                <!--Humidité-->
               
                    <label for="" class="block mb-2 text-sm font-medium text-gray-900 ">Préciser les seuils d'humidité dans ce
                      local (%)</label>
                    <div class="flex gap-6 items-center justify-between">
                      <div class="flex items-center gap-6">
                        <label for="" class="block mb-2 text-sm font-medium text-gray-500 " style="min-width: fit-content;">De
                          :</label>
                        <input [(ngModel)]="humiditeMin[index]" placeholder="" type="number" id="humiditeMin" name="humiditeMin"
                          class="my-2 bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-blue-600 focus:border-blue-600 block w-full p-2.5 -700 hover:shadow-md">
                      </div>
                      <div class="flex items-center gap-6">
                        <label for="" class="block mb-2 text-sm font-medium text-gray-500 " style="min-width: fit-content;">à
                          :</label>
                        <input [(ngModel)]="humiditeMax[index]" placeholder="" type="number" id="humiditeMax" name="humiditeMax"
                          class="my-2 bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-blue-600 focus:border-blue-600 block w-full p-2.5 -700 hover:shadow-md">
                      </div>
                    </div>
                

                                                  </div>
                                              
                                           
                  
                                            <button *ngIf="(nomsZones[index]) || (typeLocalSelectionne[index])"
                                              (click)="ajouterNewZone( nomsZones[index] || typeLocalSelectionne[index] , tousLesEtagesSansException[indiceEtage2Courant],index,temperatureMax[index],temperatureMin[index],humiditeMax[index],humiditeMin[index])"
                                              [class.enfonce]="boutonsAjouterLocalEnfonce[index]"
                                              class="px-5 mx-2 my-2 font-medium text-white transition-colors duration-300 transform bg-[#3b82f6] rounded-md disabled:bg-gray-300 hover:bg-blue-300 focus:outline-none whitespace-nowrap">
                                              {{'architecture.ajouter' | translate }}
                                            </button>
                                          
                  
                                        </div>
                  
                                      </div>
                                    </ng-container>
                                  </div>
                  
                                </div>
                  
                  
                  
                               
                  
                  
                                <button *ngIf="indiceEtage2Courant < nombreEtages-1"
                                  (click)="prochainEtage(tousLesEtagesSansException[indiceEtage2Courant])"
                                  class="px-5 py-2 text-white transition-colors duration-300 transform bg-blue-400 rounded-md disabled:bg-gray-300 hover:bg-blue-300 focus:outline-none whitespace-nowrap">
                                  >
                                  {{'architecture.etageSuivant'|translate}}
                                </button>
                              </div>
                            </div>
                  
                          </div>
                    </div>
                          <ng-container *ngIf="tousLesNomsLocaux.length > 0">
                            <div class="flex flex-wrap lg:w-4/5 sm:mx-auto sm:mb-2 -mx-2 p-4">
                              <div *ngFor="let nom of tousLesNomsLocaux" class="p-6 sm:w-1/2 w-full">
                                <div class="bg-gray-100 rounded flex p-4 h-full items-center">
                                  <svg fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"
                                    stroke-width="3" class="text-indigo-500 w-6 h-6 flex-shrink-0 mr-4" viewBox="0 0 24 24">
                                    <path d="M22 11.08V12a10 10 0 11-5.93-9.14"></path>
                                    <path d="M22 4L12 14.01l-3-3"></path>
                                  </svg>
                                  Local: <span class="font-medium">{{ nom }} ajouté</span>
                                </div>
                              </div>
                            </div>
                          </ng-container>   
                                    
                       
                    </div>
                       </div>
                <div class="w-full flex justify-between p-2 bg-gray-200 dark:bg-gray-800">
                    <button id="prev-btn" class="sm:px-8 xs:px-4 py-2 bg-blue-400 text-white rounded-lg" (click)="prevStep()" [disabled]="currentStep === 1">Previous</button>
                    <button id="next-btn" class="sm:px-8 xs:px-4 py-2 bg-blue-700 text-white rounded-lg" (click)="nextStep()">Next</button>
                </div>
            </div>
            
        </div>
    </div>
    <div *ngIf="otherAdd" class="relative z-10"
    aria-labelledby="modal-title" role="dialog" aria-modal="true">
    <div class="fixed inset-0 bg-gray-500 bg-opacity-20 transition-opacity"></div>

    <div class="fixed inset-0 z-10 w-screen overflow-y-auto">
      <div
        class="flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0">
        <div
          class="relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg">
          <div class="bg-white px-4 pb-4 pt-5 sm:p-6 sm:pb-4">
            <div class="sm:flex sm:items-start">
              <div
                class="mx-auto flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full bg-red-100 sm:mx-0 sm:h-10 sm:w-10">
                <svg class="h-6 w-6 text-red-600" fill="none" viewBox="0 0 24 24"
                  stroke-width="1.5" stroke="currentColor" aria-hidden="true">
                  <path stroke-linecap="round" stroke-linejoin="round"
                    d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z" />
                </svg>
              </div>
              <div class="mt-3 text-center sm:ml-4 sm:mt-0 sm:text-left">
                <h3 class="text-base font-semibold leading-6 text-gray-900"
                  id="modal-title">Voulez vous Quitter ou ajouter un autre batiment?</h3>
                <div class="mt-2">
                  <p class="text-sm text-gray-500">{{'ajoutC1.title55'|
                    translate}}</p>
                </div>
              </div>
            </div>
          </div>
          <div class="bg-gray-50 px-4 py-3 sm:flex sm:flex-row-reverse sm:px-6">
            <button (click)="finish()" type="button"
              class="inline-flex w-full justify-center rounded-md bg-red-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-red-500 sm:ml-3 sm:w-auto">
            Quitter
            </button>
            <button (click)="nextBatiment()" type="button"
              class="mt-3 inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:mt-0 sm:w-auto">Continuer</button>
          </div>
        </div>
      </div>
    </div>
  </div>
   <!-- <div *ngIf="otherAdd">
        Voulez-vous ajouter un autre bâtiment ?
        <button id="prev-btn" class="sm:px-8 xs:px-4 py-2 bg-blue-400 text-white rounded-lg" (click)="finish()">Quitter</button>
        <button id="next-btn" class="sm:px-8 xs:px-4 py-2 bg-blue-700 text-white rounded-lg" (click)="nextBatiment()">OUI</button>
    </div>  -->
</section>
